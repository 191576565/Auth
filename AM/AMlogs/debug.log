2017-04-13 15:06:06 DEBUG <sql加载, sql file = applogin.sql.xml, sql key = tianjian.app.applogin, sql content =  update SYS_USER_INFO set loggin_status_m=? , user_sid_m = ? where user_id = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = applogin.sql.xml, sql key = tianjian.app.applogout, sql content =  update SYS_USER_INFO set loggin_status_m=? , user_sid_m = ? where user_id = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = applogin.sql.xml, sql key = tianjian.app.rpmselect1, sql content =  with tmp_roles as ( select t0.user_id ,dao_concat(t1.role_id ) as role_id ,dao_concat(t1.role_name) as role_name from sys_user_info t0 left join sys_role_info t1 on DBMS_LOB.INSTR(t0.roles ,t1.uuid)>0 group by t0.user_id ) ,tmp_users as ( select t2.domain_id ,t2.domain_name ,t3.org_unit_id ,t3.org_unit_desc ,t0.user_id ,t0.user_name ,t4.uuid as res_uuid ,t4.res_id as res_id ,t4.res_name as res_name ,t4.res_url as res_url ,nvl(t5.res_id,'#') as res_up_id ,t4.res_class as res_css ,t4.res_color as res_color ,t4.res_icon as res_icon ,t4.res_type as res_type ,t4.sort_id as res_sort_id from sys_user_info t0 left join sys_role_info t1 on DBMS_LOB.INSTR(t0.roles ,t1.uuid)>0 left join sys_domain_info t2 on t0.domain_uuid=t2.uuid left join sys_org_info t3 on t0.org_uuid=t3.uuid and t0.domain_uuid=t3.domain_uuid left join sys_resource_info t4 on DBMS_LOB.INSTR(t1.resources ,t4.uuid)>0 left join sys_resource_info t5 on t4.res_up_uuid=t5.uuid where ${column} = ? and ${session} = ? and loggin_status_m = '0' group by t2.domain_id ,t2.domain_name ,t3.org_unit_id ,t3.org_unit_desc ,t0.user_id ,t0.user_name ,t4.uuid ,t4.res_id ,t4.res_name ,t4.res_url ,nvl(t5.res_id,'#') ,t4.res_class ,t4.res_color ,t4.res_icon ,t4.res_type ,t4.sort_id ) select tu.domain_id, tu.domain_name, tu.org_unit_id, tu.org_unit_desc, tu.user_id, tu.user_name, tr.role_id, tr.role_name, tu.res_id, tu.res_name, tu.res_url, tu.res_up_id, tu.res_css, tu.res_color, tu.res_icon, tu.res_type from tmp_users tu left join tmp_roles tr on tu.user_id=tr.user_id start with res_uuid =domain_id connect by prior res_id =res_up_id order by tu.res_sort_id >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = applogin.sql.xml, sql key = tianjian.app.rpmselect2, sql content =  SELECT T2.DOMAIN_ID ,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME ,T7.GROUP_ID ,T81.REQ_URL ,T81.CONDITION_TYPE ,dao_concat(t9.org_unit_id ) AS CONDITION_CONTENT ,dao_concat(t9.org_unit_desc) AS CONTENT_DESC FROM SYS_USER_INFO T0 LEFT JOIN SYS_DOMAIN_INFO T2 ON T0.DOMAIN_UUID=T2.UUID LEFT JOIN SYS_ORG_INFO T3 ON T0.ORG_UUID=T3.UUID and t0.domain_uuid=t3.domain_uuid JOIN SYS_GROUP_INFO T7 ON T0.DOMAIN_UUID=T7.DOMAIN_UUID AND DBMS_LOB.INSTR(T7.USERS ,T0.UUID)>0 LEFT JOIN sys_group_url_rela T8 ON T7.UUID =T8.GROUP_UUID LEFT JOIN SYS_GROUP_URL_MAPPING T81 ON T8.REQ_URL=T81.UUID LEFT JOIN SYS_ORG_INFO T9 ON DBMS_LOB.INSTR(T8.CONDITION_CONTENT ,T9.uuid)>0 AND T9.DOMAIN_UUID=T0.DOMAIN_UUID WHERE T0.DOMAIN_UUID IN ( select d.uuid from SYS_DOMAIN_INFO D where d.domain_id='rpm') AND ${column} = ? and ${session} = ? and loggin_status_m = '0' GROUP BY T2.DOMAIN_ID,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME,T7.GROUP_ID,T81.REQ_URL,T81.CONDITION_TYPE,T8.CONDITION_CONTENT,T0.LOGGIN_STATUS ,T0.USER_SID >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = applogin.sql.xml, sql key = tianjian.app.rpmselect3, sql content =  SELECT T2.DOMAIN_ID ,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME ,dao_concat(T1.ROLE_ID ) AS ROLE_IDS ,dao_concat(T1.ROLE_NAME) AS ROLE_NAMES ,T0.LOGGIN_STATUS_M ,T0.USER_SID_M FROM SYS_USER_INFO T0
LEFT JOIN SYS_ROLE_INFO T1 ON DBMS_LOB.INSTR(T0.ROLES ,T1.UUID)>0
LEFT JOIN SYS_DOMAIN_INFO T2 ON T0.DOMAIN_UUID=T2.UUID
LEFT JOIN SYS_ORG_INFO T3 ON T0.ORG_UUID=T3.UUID and t0.domain_uuid=t3.domain_uuid WHERE ( 1=1 or 1 = ? ) and ${session} = ? and loggin_status_m = '0'
GROUP BY t2.UUID,T2.DOMAIN_ID,T2.DOMAIN_NAME ,T3.UUID ,T3.ORG_UNIT_ID,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME ,T0.LOGGIN_STATUS_M ,T0.USER_SID_M >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.userTree, sql content =  with org_user as (
SELECT t4.uuid org_user_uuid ,t4.user_name org_user_name , T3.UUID org_up_uuid ,'1' flag FROM sys_user_info t4 JOIN (SELECT T3.UUID ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T3.ORG_UP_UUID FROM SYS_ORG_INFO T3 LEFT JOIN SYS_DOMAIN_INFO T2 ON T3.DOMAIN_UUID=T2.UUID where t2.DOMAIN_ID=? start with t3.ORG_UP_UUID= (select uuid from sys_org_info c where c.org_up_uuid='#') connect by prior t3.uuid =t3.org_up_uuid) T3 on t4.org_uuid=T3 .uuid union all
SELECT T3.UUID org_user_uuid ,T3.ORG_UNIT_DESC org_user_name ,T3.ORG_UP_UUID ,'0' flag FROM SYS_ORG_INFO T3
LEFT JOIN SYS_DOMAIN_INFO T2 ON T3.DOMAIN_UUID=T2.UUID where t2.DOMAIN_ID=?
start with t3.ORG_UP_UUID= (select uuid from sys_org_info c where c.org_up_uuid='#') connect by prior t3.uuid =t3.org_up_uuid
)
select t.org_user_uuid id,t.org_user_name name,t.org_up_uuid pid,t.flag
from org_user t >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.urlSelect, sql content =  SELECT T1.DOMAIN_NAME ,T.REQ_URL ,T.REQ_URL_DESC ,T.CONDITION_TYPE ,T2.DICT_NAME ,T.UUID
FROM SYS_GROUP_URL_MAPPING T
LEFT JOIN SYS_DOMAIN_INFO T1 ON T.DOMAIN_UUID=T1.UUID
LEFT JOIN SYS_DICT_INFO T2 ON T.CONDITION_TYPE=T2.DICT_ID AND T2.DICT_TYPE='effecive_flag'
where t1.domain_id= ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.typeSelect, sql content =  SELECT DISTINCT T2.DICT_ID,T2.DICT_NAME FROM SYS_GROUP_URL_MAPPING T JOIN SYS_DOMAIN_INFO T1 ON T.DOMAIN_UUID=T1.UUID AND T1.DOMAIN_ID=?
LEFT JOIN SYS_DICT_INFO T2 ON T.CONDITION_TYPE=T2.DICT_ID AND T2.DICT_TYPE='effective_flag' >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.typeUrlSelect, sql content =  SELECT T.UUID,T.REQ_URL_DESC,T.CONDITION_TYPE FROM SYS_GROUP_URL_MAPPING T WHERE T.CONDITION_TYPE = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.orgTree, sql content =  SELECT T3.UUID AS ID ,T3.ORG_UNIT_DESC AS NAME ,T3.ORG_UP_UUID AS PID FROM SYS_ORG_INFO T3 LEFT JOIN SYS_DOMAIN_INFO T2 ON T3.DOMAIN_UUID=T2.UUID where T2.DOMAIN_ID=? start with t3.ORG_UP_UUID= (select uuid from sys_org_info c where c.org_up_uuid='#') connect by prior t3.uuid =t3.org_up_uuid >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.groupCodeSelect, sql content =  select T7.UUID AS GROUP_UUID ,T7.Group_Desc from SYS_GROUP_INFO T7 LEFT JOIN SYS_DOMAIN_INFO T2 ON T7.DOMAIN_UUID=T2.UUID WHERE T7.UUID=? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.loadEditParam, sql content =  SELECT T7.UUID AS GROUP_UUID ,T7.Group_Desc ,t81.uuid AS URL_UUID ,T81.REQ_URL ,t81.req_url_desc ,T10.DICT_ID AS CONDITION_TYPE ,T10.DICT_NAME AS CONDITION_TYPE_NAME ,dao_concat(T9.ORG_UNIT_ID ) AS CONDITION_CONTENT ,dao_concat(T9.ORG_UNIT_DESC ) AS CONTENT_DESC FROM SYS_GROUP_URL_RELA T8 JOIN SYS_GROUP_INFO T7 ON T8.GROUP_UUID=T7.UUID
LEFT JOIN SYS_DOMAIN_INFO T2 ON T7.DOMAIN_UUID=T2.UUID
LEFT JOIN SYS_GROUP_URL_MAPPING T81 ON T8.REQ_URL=T81.UUID
LEFT JOIN SYS_ORG_INFO T9 ON DBMS_LOB.INSTR(T8.CONDITION_CONTENT ,T9.UUID)>0 AND T9.DOMAIN_UUID=T2.UUID
LEFT JOIN SYS_DICT_INFO T10 ON T10.DICT_ID=T81.CONDITION_TYPE AND T10.DICT_TYPE='effective_flag'
WHERE T8.UUID=?
GROUP BY T7.UUID ,T7.Group_Desc ,t81.uuid ,T81.REQ_URL ,t81.req_url_desc ,T10.DICT_ID ,T10.DICT_NAME >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.domainInfo, sql content =  select * from SYS_DOMAIN_INFO t start with decode(?,'root',domain_up_uuid,uuid)=? connect by prior uuid = domain_up_uuid >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.getUsers, sql content =  select USERS from sys_group_info where uuid=? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.paramSelect, sql content =  select t.uuid, t1.domain_id, t1.domain_name, t.group_id, t.group_desc, dao_concat(T4.UUID ) AS users from sys_group_info t join sys_domain_info t1 on t.domain_uuid = t1.uuid left join sys_user_info T4 ON DBMS_LOB.INSTR(T.USERS ,T4.UUID)>0 where ( decode(?,'root', 1,null )=1 or t.domain_uuid= ? ) and domain_id !='root' and ( t.group_id like ? or t.group_desc like ? ) GROUP BY t.uuid, t1.domain_id, t1.domain_name, t.group_id, t.group_desc order by t1.domain_id, t.group_id >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.pageSelect, sql content =  select t.uuid, t1.domain_id, t1.domain_name, t.group_id, t.group_desc, dao_concat(T4.UUID ) AS users from sys_group_info t join sys_domain_info t1 on t.domain_uuid = t1.uuid left join sys_user_info T4 ON DBMS_LOB.INSTR(T.USERS ,T4.UUID)>0 where ( decode(?,'root', 1,null )=1 or t.domain_uuid= ? ) and domain_id !='root' GROUP BY t.uuid, t1.domain_id, t1.domain_name, t.group_id, t.group_desc order by t1.domain_id, t.group_id >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.gouPageSelect, sql content =  select t8.uuid ,T10.DOMAIN_NAME ,T11.GROUP_ID ,T11.GROUP_DESC ,T81.REQ_URL ,T81.REQ_URL_DESC ,T12.DICT_NAME CONDITION_TYPE ,t8.condition_content AS condition_content_uuid from sys_group_url_rela T8 LEFT JOIN SYS_GROUP_URL_MAPPING T81 ON T8.REQ_URL=T81.UUID LEFT JOIN SYS_ORG_INFO T9 ON DBMS_LOB.INSTR( T8.CONDITION_CONTENT ,T9.uuid )>0 AND T9.DOMAIN_UUID=T81.DOMAIN_UUID left join sys_domain_info t10 ON T10.UUID=T81.DOMAIN_UUID LEFT JOIN SYS_GROUP_INFO T11 ON T11.UUID=T8.GROUP_UUID LEFT JOIN SYS_DICT_INFO T12 ON T12.DICT_ID =T81.CONDITION_TYPE AND T12.DICT_TYPE='effective_flag' where t8.group_uuid=? group by t8.uuid ,T10.DOMAIN_NAME ,T11.GROUP_ID ,T11.GROUP_DESC ,T12.DICT_NAME ,T81.REQ_URL_DESC ,T81.REQ_URL ,t8.condition_content >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.dpg.gouParamSelect, sql content =  select t8.uuid ,T10.DOMAIN_NAME ,T11.GROUP_ID ,T11.GROUP_DESC ,T81.REQ_URL ,T81.REQ_URL_DESC ,T12.DICT_NAME CONDITION_TYPE ,t8.condition_content AS condition_content_uuid from sys_group_url_rela T8 LEFT JOIN SYS_GROUP_URL_MAPPING T81 ON T8.REQ_URL=T81.UUID LEFT JOIN SYS_ORG_INFO T9 ON DBMS_LOB.INSTR( T8.CONDITION_CONTENT ,T9.uuid )>0 AND T9.DOMAIN_UUID=T81.DOMAIN_UUID left join sys_domain_info t10 ON T10.UUID=T81.DOMAIN_UUID LEFT JOIN SYS_GROUP_INFO T11 ON T11.UUID=T8.GROUP_UUID LEFT JOIN SYS_DICT_INFO T12 ON T12.DICT_ID =T81.CONDITION_TYPE AND T12.DICT_TYPE='effective_flag' where t8.group_uuid=? and ( T81.REQ_URL_DESC like ? ) group by t8.uuid ,T10.DOMAIN_NAME ,T11.GROUP_ID ,T11.GROUP_DESC ,T12.DICT_NAME ,T81.REQ_URL_DESC ,T81.REQ_URL ,t8.condition_content >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = login.sql.xml, sql key = tianjian.login.ucheck, sql content =  select user_pwd from SYS_USER_INFO where user_id=? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = login.sql.xml, sql key = tianjian.login.tcheck, sql content =  <% if(db_type == "mysql" || db_type == "postgresql"){ %> select * from pt_operator order by ids asc limit ? offset ? <% } else if(db_type == "oracle"){ %> select * from ( select a.*, rownum rn from (select * from pt_operator) a where rownum <= ? ) where rn >= ? <% } else if(db_type == "sqlserver"){ %> select top {0, number, #.#} * from pt_operator where ids not in ( select top {1, number, #.#} ids from pt_operator ) <% } else if(db_type == "db2"){ %> select * from ( select b.*, rownumber() over() as rn from ( select * from pt_operator ) as b ) as a where a.rn < ? and a.rn >= ? <% } %> >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = login.sql.xml, sql key = tianjian.login.postsid, sql content =  select user_sid from SYS_USER_INFO where user_id = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = login.sql.xml, sql key = tianjian.login.posturl, sql content =  select REGEXP_SUBSTR(RES_URL,'[[:alpha:]]+://([1-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){3}:[0-9]{2,5}',1,1,'i') iport from sys_resource_info t where uuid = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = menu.sql.xml, sql key = tianjian.menu.sysSelect, sql content =  WITH TMP_USERS AS ( SELECT T2.DOMAIN_ID ,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME ,min(t4.RES_ID) over(partition by t2.domain_id) AS TOP_RES_ID ,T4.UUID AS RES_UUID ,T4.RES_UP_UUID AS RES_UP_UUID ,T4.RES_ID AS RES_ID ,T4.RES_NAME AS RES_NAME ,T4.RES_URL AS RES_URL ,nvl(T5.RES_ID,'#') AS RES_UP_ID ,T4.RES_CLASS AS RES_CSS ,T4.RES_COLOR AS RES_COLOR ,T4.RES_ICON AS RES_ICON ,T4.RES_TYPE AS RES_TYPE FROM SYS_USER_INFO T0 LEFT JOIN SYS_ROLE_INFO T1 ON DBMS_LOB.INSTR(T0.ROLES ,T1.UUID)>0 LEFT JOIN SYS_DOMAIN_INFO T2 ON T0.DOMAIN_UUID=T2.UUID LEFT JOIN SYS_ORG_INFO T3 ON T0.ORG_UUID=T3.UUID and t0.domain_uuid=t3.domain_uuid LEFT JOIN SYS_RESOURCE_INFO T4 ON decode(t2.domain_id,'root',1,DBMS_LOB.INSTR(T1.RESOURCES ,T4.UUID))>0 LEFT JOIN SYS_RESOURCE_INFO T5 ON T4.RES_UP_UUID=T5.UUID where user_id =? group by T2.DOMAIN_ID ,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME,T4.UUID ,T4.RES_UP_UUID ,T4.RES_ID ,T4.RES_NAME ,T4.RES_URL ,nvl(T5.RES_ID,'#') ,T4.RES_CLASS ,T4.RES_COLOR ,T4.RES_ICON ,T4.RES_TYPE ) SELECT * FROM TMP_USERS where res_up_uuid= ( select distinct uuid from SYS_RESOURCE_INFO where res_up_uuid='#' ) >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = menu.sql.xml, sql key = tianjian.menu.funSelect, sql content =  WITH TMP_USERS AS ( SELECT T2.DOMAIN_ID ,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME ,min(t4.RES_ID) over(partition by t2.domain_id) AS TOP_RES_ID ,T4.UUID AS RES_UUID ,T4.RES_UP_UUID AS RES_UP_UUID ,T4.RES_ID AS RES_ID ,T4.RES_NAME AS RES_NAME ,T4.RES_URL AS RES_URL ,nvl(T5.RES_ID,'#') AS RES_UP_ID ,T4.RES_CLASS AS RES_CSS ,T4.RES_COLOR AS RES_COLOR ,T4.RES_ICON AS RES_ICON ,T4.RES_TYPE AS RES_TYPE FROM SYS_USER_INFO T0 LEFT JOIN SYS_ROLE_INFO T1 ON DBMS_LOB.INSTR(T0.ROLES ,T1.UUID)>0 LEFT JOIN SYS_DOMAIN_INFO T2 ON T0.DOMAIN_UUID=T2.UUID LEFT JOIN SYS_ORG_INFO T3 ON T0.ORG_UUID=T3.UUID and t0.domain_uuid=t3.domain_uuid LEFT JOIN SYS_RESOURCE_INFO T4 ON decode(t2.domain_id,'root',1,DBMS_LOB.INSTR(T1.RESOURCES ,T4.UUID))>0 LEFT JOIN SYS_RESOURCE_INFO T5 ON T4.RES_UP_UUID=T5.UUID where USER_ID =? group by T2.DOMAIN_ID ,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME,T4.UUID ,T4.RES_UP_UUID ,T4.RES_ID ,T4.RES_NAME ,T4.RES_URL ,nvl(T5.RES_ID,'#') ,T4.RES_CLASS ,T4.RES_COLOR ,T4.RES_ICON ,T4.RES_TYPE ) SELECT t.DOMAIN_ID, t.DOMAIN_NAME, t.ORG_UNIT_ID, t.ORG_UNIT_DESC, t.USER_ID, t.USER_NAME, t.TOP_RES_ID, t.RES_UUID, t.RES_UP_UUID, t.RES_ID, t.RES_NAME, t.RES_URL, t.RES_UP_ID, t.RES_CSS, t.RES_COLOR, t.RES_ICON, t.RES_TYPE, level as lvl FROM TMP_USERS t start with RES_UP_UUID ='auth' connect by prior res_uuid =res_up_uuid >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = dpgmgmt.sql.xml, sql key = tianjian.dpgmgmt.pageAllSelect, sql content =  select t.uuid, t1.domain_id, t1.domain_name, t.group_id, t.group_desc, dao_concat(T4.UUID ) AS users from sys_group_info t join sys_domain_info t1 on t.domain_uuid = t1.uuid left join sys_user_info T4 ON DBMS_LOB.INSTR(T.USERS ,T4.UUID)>0 where ( decode(?,'root', 1,null )=1 or t.domain_uuid= ? ) and domain_id !='root' GROUP BY t.uuid, t1.domain_id, t1.domain_name, t.group_id, t.group_desc order by t1.domain_id, t.group_id >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = dpgmgmt.sql.xml, sql key = tianjian.dpgmgmt.gouAllSelect, sql content =  select t8.uuid ,T10.DOMAIN_NAME ,T11.GROUP_ID ,T11.GROUP_DESC ,T81.REQ_URL ,T81.REQ_URL_DESC ,T12.DICT_NAME CONDITION_TYPE ,t8.condition_content AS condition_content_uuid from sys_group_url_rela T8 LEFT JOIN SYS_GROUP_URL_MAPPING T81 ON T8.REQ_URL=T81.UUID LEFT JOIN SYS_ORG_INFO T9 ON DBMS_LOB.INSTR( T8.CONDITION_CONTENT ,T9.uuid )>0 AND T9.DOMAIN_UUID=T81.DOMAIN_UUID left join sys_domain_info t10 ON T10.UUID=T81.DOMAIN_UUID LEFT JOIN SYS_GROUP_INFO T11 ON T11.UUID=T8.GROUP_UUID LEFT JOIN SYS_DICT_INFO T12 ON T12.DICT_ID =T81.CONDITION_TYPE AND T12.DICT_TYPE='effective_flag' where t8.group_uuid=? group by t8.uuid ,T10.DOMAIN_NAME ,T11.GROUP_ID ,T11.GROUP_DESC ,T12.DICT_NAME ,T81.REQ_URL_DESC ,T81.REQ_URL ,t8.condition_content >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = dpgmgmt.sql.xml, sql key = tianjian.dpgmgmt.domaininfo, sql content =  select * from SYS_DOMAIN_INFO t where 1=1 <% if(domain_id == "root"){ %> <% } else if(!isEmpty(domain_id)){%> and t.domain_id=#'$domain_id$'# <% } %> >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = dpgmgmt.sql.xml, sql key = tianjian.dpgmgmt.dictcode, sql content =  select t3.group_desc, t3.dict_id,t3.sort,t3.dict_name,t3.domain_id from ( select distinct t1.group_desc, t.dict_id,t.sort, case when t.dict_name is null then '解析字典出错！' else t.dict_name end dict_name,t2.domain_id from ( select group_desc,domain_uuid,uuid from sys_group_info where uuid = #'$groupuuid$'#) t1 left join sys_dict_info t on t.domain_uuid =t1.domain_uuid and t.dict_visible='0' LEFT JOIN sys_domain_info t2 on t1.domain_uuid=t2.uuid ) t3 order by t3.sort >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = dpgmgmt.sql.xml, sql key = tianjian.dpgmgmt.ingroupinfo, sql content =  insert into sys_group_info (uuid, domain_uuid, group_id, group_desc, created_date, creator, modified_date, modifier, memo, users) select sys_guid(), max(t.uuid), #'$groupid$'#, #'$groupname$'#, sysdate, #'$opuser$'#, sysdate, #'$opuser$'#, '', #'$guserid$'# from SYS_DOMAIN_INFO t WHERE t.domain_id =#'$domainid$'# >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = dpgmgmt.sql.xml, sql key = tianjian.dpgmgmt.ingroupurl, sql content =  insert into sys_group_url_rela (UUID, GROUP_UUID, GROUP_NAME, REQ_URL, REQ_URL_DESC, CONDITION_TYPE, CONDITION_CONTENT, CREATED_DATE, CREATOR, MODIFIED_DATE, MODIFIER, MEMO) values ( sys_guid(), #'$groupuuid$'#, null, #'$urlid$'#, #'$urlname$'#, #'$dictcode$'#, #'$dictinfo$'#, sysdate, #'$opuser$'#, sysdate, #'$opuser$'#, null ) >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = dpgmgmt.sql.xml, sql key = tianjian.dpgmgmt.upgroupinfo, sql content =  update sys_group_info t set t.group_id =#'$groupid$'#, t.group_desc = #'$groupname$'#, t.modified_date =sysdate, t.modifier =#'$opuser$'#, t.users =#'$guserid$'#, t.domain_uuid = (select max(t.uuid) from sys_domain_info t where t.domain_id = #'$domainid$'#) where t.uuid = #'$uuid$'# >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = dpgmgmt.sql.xml, sql key = tianjian.dpgmgmt.upgroupurl, sql content =  update sys_group_url_rela t set t.req_url = #'$urlid$'#, t.req_url_desc = #'$urlname$'#, t.condition_type = #'$dictcode$'#, t.condition_content = #'$dictinfo$'#, t.modified_date = sysdate, t.modifier = #'$opuser$'# where t.uuid = #'$uuid$'# >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = dpgmgmt.sql.xml, sql key = tianjian.dpgmgmt.deletegid, sql content =  delete from sys_group_info t where t.uuid in (#'$para$'#) >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = dpgmgmt.sql.xml, sql key = tianjian.dpgmgmt.deleteurl, sql content =  delete from sys_group_url_rela t where t.uuid in (#'$para$'#) >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = dpgmgmt.sql.xml, sql key = tianjian.dpgmgmt.verifygid, sql content =  select t.domain_uuid from sys_group_info t, sys_domain_info t1 where t.domain_uuid = t1.uuid and t.group_id = #'$groupid$'# and t1.domain_id = #'$domainid$'# >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = dpgmgmt.sql.xml, sql key = tianjian.dpgmgmt.verifyurl, sql content =  select t.uuid from sys_group_url_rela t WHERE t.group_uuid=#'$groupuuid$'# AND t.req_url=#'$urlid$'# >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.paging, sql content =  <% if(db_type == "mysql" || db_type == "postgresql"){ %> select * from pt_user order by ids asc limit ? offset ? <% } else if(db_type == "oracle"){ %> select * from ( select a.*, rownum rn from (select * from pt_user) a where rownum < ? ) where rn >= ? <% } else if(db_type == "sqlserver"){ %> select top {0, number, #.#} * from pt_user where ids not in ( select top {1, number, #.#} ids from pt_user ) <% } else if(db_type == "db2"){ %> select * from ( select b.*, rownumber() over() as rn from ( select * from pt_user ) as b ) as a where a.rn < ? and a.rn >= ? <% } %> >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.userinfo, sql content =  select t2.uuid as domain_uuid, t2.domain_id, t2.domain_name, t3.uuid as org_uuid, t3.org_unit_id, t3.org_unit_desc, t0.uuid as user_uuid, t0.user_id, t0.user_name, t0.user_pwd, dao_concat(t1.uuid) as role_uuids, dao_concat(t1.role_id) as role_ids, dao_concat(t1.role_name) as role_names from sys_user_info t0 left join sys_role_info t1 on DBMS_LOB.INSTR(t0.roles, t1.uuid) > 0 left join sys_domain_info t2 on t0.domain_uuid = t2.uuid left join sys_org_info t3 on t0.org_uuid = t3.uuid and t0.domain_uuid = t3.domain_uuid where t0.user_id = ? group by t2.uuid, t2.domain_id, t2.domain_name, t3.uuid, t3.org_unit_id, t3.org_unit_desc, t0.uuid, t0.user_id, t0.user_name, t0.user_pwd >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.rpmselect0, sql content =  select * from ${table} where ${column} = ? and ${session} = ? and loggin_status = '0' >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.rpmselect1, sql content =  with tmp_roles as ( select t0.user_id ,dao_concat(t1.role_id ) as role_id ,dao_concat(t1.role_name) as role_name from sys_user_info t0 left join sys_role_info t1 on DBMS_LOB.INSTR(t0.roles ,t1.uuid)>0 group by t0.user_id ) ,tmp_users as ( select t2.domain_id ,t2.domain_name ,t3.org_unit_id ,t3.org_unit_desc ,t0.user_id ,t0.user_name ,t4.uuid as res_uuid ,t4.res_id as res_id ,t4.res_name as res_name ,t4.res_url as res_url ,nvl(t5.res_id,'#') as res_up_id ,t4.res_class as res_css ,t4.res_color as res_color ,t4.res_icon as res_icon ,t4.res_type as res_type ,t4.sort_id as res_sort_id from sys_user_info t0 left join sys_role_info t1 on DBMS_LOB.INSTR(t0.roles ,t1.uuid)>0 left join sys_domain_info t2 on t0.domain_uuid=t2.uuid left join sys_org_info t3 on t0.org_uuid=t3.uuid and t0.domain_uuid=t3.domain_uuid left join sys_resource_info t4 on DBMS_LOB.INSTR(t1.resources ,t4.uuid)>0 left join sys_resource_info t5 on t4.res_up_uuid=t5.uuid where ${column} = ? and ${session} = ? and loggin_status = '0' group by t2.domain_id ,t2.domain_name ,t3.org_unit_id ,t3.org_unit_desc ,t0.user_id ,t0.user_name ,t4.uuid ,t4.res_id ,t4.res_name ,t4.res_url ,nvl(t5.res_id,'#') ,t4.res_class ,t4.res_color ,t4.res_icon ,t4.res_type ,t4.sort_id ) select tu.domain_id, tu.domain_name, tu.org_unit_id, tu.org_unit_desc, tu.user_id, tu.user_name, tr.role_id, tr.role_name, tu.res_id, tu.res_name, tu.res_url, tu.res_up_id, tu.res_css, tu.res_color, tu.res_icon, tu.res_type from tmp_users tu left join tmp_roles tr on tu.user_id=tr.user_id start with res_uuid =domain_id connect by prior res_id =res_up_id order by tu.res_sort_id >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.rpmselect2, sql content =  SELECT T2.DOMAIN_ID ,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME ,T7.GROUP_ID ,T81.REQ_URL ,T81.CONDITION_TYPE ,dao_concat(t9.org_unit_id ) AS CONDITION_CONTENT ,dao_concat(t9.org_unit_desc) AS CONTENT_DESC FROM SYS_USER_INFO T0 LEFT JOIN SYS_DOMAIN_INFO T2 ON T0.DOMAIN_UUID=T2.UUID LEFT JOIN SYS_ORG_INFO T3 ON T0.ORG_UUID=T3.UUID and t0.domain_uuid=t3.domain_uuid JOIN SYS_GROUP_INFO T7 ON T0.DOMAIN_UUID=T7.DOMAIN_UUID AND DBMS_LOB.INSTR(T7.USERS ,T0.UUID)>0 LEFT JOIN sys_group_url_rela T8 ON T7.UUID =T8.GROUP_UUID LEFT JOIN SYS_GROUP_URL_MAPPING T81 ON T8.REQ_URL=T81.UUID LEFT JOIN SYS_ORG_INFO T9 ON DBMS_LOB.INSTR(T8.CONDITION_CONTENT ,T9.uuid)>0 AND T9.DOMAIN_UUID=T0.DOMAIN_UUID WHERE T0.DOMAIN_UUID IN ( select d.uuid from SYS_DOMAIN_INFO D where d.domain_id='rpm') AND ${column} = ? and ${session} = ? and loggin_status = '0' GROUP BY T2.DOMAIN_ID,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME,T7.GROUP_ID,T81.REQ_URL,T81.CONDITION_TYPE,T8.CONDITION_CONTENT,T0.LOGGIN_STATUS ,T0.USER_SID >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.rpmselect3, sql content =  SELECT T2.DOMAIN_ID ,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME ,dao_concat(T1.ROLE_ID ) AS ROLE_IDS ,dao_concat(T1.ROLE_NAME) AS ROLE_NAMES ,T0.LOGGIN_STATUS ,T0.USER_SID FROM SYS_USER_INFO T0
LEFT JOIN SYS_ROLE_INFO T1 ON DBMS_LOB.INSTR(T0.ROLES ,T1.UUID)>0
LEFT JOIN SYS_DOMAIN_INFO T2 ON T0.DOMAIN_UUID=T2.UUID
LEFT JOIN SYS_ORG_INFO T3 ON T0.ORG_UUID=T3.UUID and t0.domain_uuid=t3.domain_uuid
WHERE ( 1=1 or 1 = ? ) and ${session} = ? and loggin_status = '0'
GROUP BY t2.UUID,T2.DOMAIN_ID,T2.DOMAIN_NAME ,T3.UUID ,T3.ORG_UNIT_ID,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME ,T0.LOGGIN_STATUS ,T0.USER_SID >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.uloginw, sql content =  update ${table} set loggin_status='1' where ${column} = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.ulogino, sql content =  update ${table} set loggin_status=? , user_sid = ? where ${column} = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.column, sql content =  select * from ${table} where ${column} = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.stop, sql content =  update pt_user set stopDate = ?, errorCount = ? where ids = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.start, sql content =  update pt_user set stopdate = null, errorcount = 0 where ids = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.splitPageSelect, sql content =  select u.ids, u.username, u.names, u.email, u.mobile, ui.birthday, d.names as deptnames >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = user.sql.xml, sql key = model.user.splitPageFrom, sql content =  from pt_user u left join pt_userinfo ui on u.ids = ui.ids left join pt_department d on u.departmentids = d.ids where 1=1 <% if(!isEmpty(userClass)){ %> and u.userClass = #'$userClass$'# <% } %> <% if(!isEmpty(userName)){ %> and u.userName like #'%$userName$%'# <% } %> <% if(!isEmpty(names)){ %> and u.names like #'%$names$%'# <% } %> <% if(!isEmpty(email)){ %> and u.email like #'%$email$%'# <% } %> <% if(!isEmpty(mobile)){ %> and u.mobile like #'%$mobile$%'# <% } %> <% if(!isEmpty(idCard)){ %> and u.idCard like #'%$idCard$%'# <% } %> <% if(!isEmpty(sex)){ %> and ui.sex like #'%$sex$%'# <% } %> <% if(!isEmpty(telephone)){ %> and ui.telephone like #'%$telephone$%'# <% } %> <% if(!isEmpty(qq)){ %> and ui.qq like #'%$qq$%'# <% } %> <% if(!isEmpty(birthday)){ %> <% if(db_type == "mysql"){ %> and ui.birthday = #'$birthday$'# <% } else if(db_type == "postgresql"){ %> and ui.birthday = to_date(#'$birthday$'#, 'YYYY-mm-dd') <% } else if(db_type == "oracle"){ %> and ui.birthday = to_date(#'$birthday$'#, 'YYYY-mm-dd') <% } else if(db_type == "sqlserver"){ %> and ui.birthday = #'$birthday$'# <% } else if(db_type == "db2"){ %> and ui.birthday = #'$birthday$'# <% }%> <% } %> >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = oplog.sql.xml, sql key = tianjian.oplog.pageAllSelect, sql content =  select * >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = oplog.sql.xml, sql key = tianjian.oplog.pageAllFrom, sql content =  from sys_log where 1=1 <% if(domain_id == "root"){ %> <% } else if(!isEmpty(domain_id)){%> and domain_id=#'$domain_id$'# <% } %> <% if(!isEmpty(user_uuid)){ %> and upper(user_name) like upper(#'%$user_uuid$%'#) <% } %> <% if(!isEmpty(op_type)){ %> and upper(op_type) like upper(#'%$op_type$%'#) <% } %> <% if(!isEmpty(startdate_start)){ %> and op_date >= to_timestamp(#'$startdate_start$'#, 'YYYY-MM-DD HH24:MI:ss') <% } %> <% if(!isEmpty(startdate_end)){ %> and op_date <= to_timestamp(#'$startdate_end$'#, 'YYYY-MM-DD HH24:MI:ss') <% } %> order by op_date desc >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = resmgmt.sql.xml, sql key = tianjian.res.restree, sql content =  select uuid as id,res_up_uuid as pid,trim(res_name) name from SYS_RESOURCE_INFO start with res_up_uuid ='#' connect by prior uuid =res_up_uuid order by res_id asc >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = resmgmt.sql.xml, sql key = tianjian.res.residrepeated, sql content =  select * from SYS_RESOURCE_INFO t where 1=1 and t.res_id = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = resmgmt.sql.xml, sql key = tianjian.res.resnamerepeated, sql content =  select * from SYS_RESOURCE_INFO t where 1=1 and res_name = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = resmgmt.sql.xml, sql key = tianjian.res.allresdata, sql content =  select t.uuid ,t.res_id ,t.res_name ,t.res_up_uuid ,t.sort_id ,t1.res_name as up_res_name ,t.res_url ,case t.res_type when '#' then '初始顶层' when '0' then '主菜单' when '1' then '子菜单' when '2' then '按钮' end res_type_name ,t.res_type ,t.res_class ,t.res_color ,t.res_icon ,level lvl from SYS_RESOURCE_INFO t left join SYS_RESOURCE_INFO t1 on t.res_up_uuid =t1.uuid start with t.res_up_uuid='#' connect by prior t.uuid =t.res_up_uuid order by lvl asc,res_id desc >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = resmgmt.sql.xml, sql key = tianjian.res.resdatadelete, sql content =  delete from SYS_RESOURCE_INFO i where i.uuid in ( select t.uuid from SYS_RESOURCE_INFO t start with t.uuid = ? connect by prior t.uuid=t.res_up_uuid) >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = resmgmt.sql.xml, sql key = tianjian.res.menuSelect, sql content =  <%if(db_type== "oracle"){%>
with TMP_ROLES as ( select T0.USER_ID ,dao_concat(T1.ROLE_ID ) AS ROLE_ID ,dao_concat(T1.ROLE_NAME ) AS ROLE_NAME FROM SYS_USER_INFO T0 LEFT JOIN SYS_ROLE_INFO T1 ON DBMS_LOB.INSTR(T0.ROLES ,T1.UUID)>0 group by T0.USER_ID )
,TMP_USERS AS ( SELECT T2.DOMAIN_ID ,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME ,T4.UUID AS RES_UUID ,T4.RES_ID AS RES_ID ,T4.RES_NAME AS RES_NAME ,T4.RES_URL AS RES_URL ,T4.RES_UP_UUID AS RES_UP_UUID ,nvl(T5.RES_ID,'#') AS RES_UP_ID ,T4.RES_CLASS AS RES_CSS ,T4.RES_COLOR AS RES_COLOR ,T4.RES_ICON AS RES_ICON ,T4.RES_TYPE AS RES_TYPE FROM SYS_USER_INFO T0 LEFT JOIN SYS_ROLE_INFO T1 ON DBMS_LOB.INSTR(T0.ROLES ,T1.UUID)>0 LEFT JOIN SYS_DOMAIN_INFO T2 ON T0.DOMAIN_UUID=T2.UUID LEFT JOIN SYS_ORG_INFO T3 ON T0.ORG_UUID=T3.UUID and t0.domain_uuid=t3.domain_uuid LEFT JOIN SYS_RESOURCE_INFO T4 ON DBMS_LOB.INSTR(T1.RESOURCES ,T4.UUID)>0 LEFT JOIN SYS_RESOURCE_INFO T5 ON T4.RES_UP_UUID=T5.UUID where user_id =? group by T2.DOMAIN_ID ,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME,T4.UUID ,T4.RES_ID ,T4.RES_NAME ,T4.RES_URL ,T4.RES_UP_UUID,nvl(T5.RES_ID,'#') ,T4.RES_CLASS ,T4.RES_COLOR ,T4.RES_ICON ,T4.RES_TYPE )
,TMP_DATA AS ( SELECT TU.RES_UUID , TU.RES_ID, TU.RES_NAME, TU.RES_URL, TU.RES_UP_UUID , TU.RES_UP_ID, TU.RES_CSS , TU.RES_COLOR, TU.RES_ICON, TU.RES_TYPE, level lvl FROM TMP_USERS TU LEFT JOIN TMP_ROLES TR ON TU.USER_ID=TR.USER_ID START WITH RES_UP_UUID=? CONNECT BY PRIOR RES_UUID=RES_UP_UUID)
SELECT * FROM TMP_DATA where lvl<=2 order by RES_ID <% } %> >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = RoleMgmt.sql.xml, sql key = tianjian.roleMgmt.defaultSelect, sql content =  Select ro.uuid,ro.Domain_uuid,Domain.Domain_Name,Ro.Role_Id,Ro.Role_Name,Ro.MEMO From Sys_Role_Info Ro
Left Join Sys_Domain_Info Domain On Ro.Domain_Uuid=Domain.Uuid where ( decode(?,'root', 1,null )=1 or ro.domain_uuid= ? ) and domain_id !='root' order by domain_id ,role_id >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = RoleMgmt.sql.xml, sql key = tianjian.roleMgmt.paramSelect, sql content =  select t.uuid,t.domain_id from sys_domain_info t where t.uuid = (select t.domain_uuid from sys_user_info t where t.user_id = ?) >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = RoleMgmt.sql.xml, sql key = tianjian.roleMgmt.repeatSelect, sql content =  select * from sys_role_info t where 1=1 and (t.role_id = ? or role_name = ?) >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = RoleMgmt.sql.xml, sql key = tianjian.roleMgmt.selectExit, sql content =  select t.* from sys_role_info t where t.uuid=? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = RoleMgmt.sql.xml, sql key = tianjian.roleMgmt.selectFunList, sql content =  WITH TMP_USERS AS ( SELECT T2.DOMAIN_ID ,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME ,min(t4.RES_ID) over(partition by t2.domain_id ) AS TOP_RES_ID ,T4.UUID AS RES_UUID ,T4.RES_UP_UUID AS RES_UP_UUID ,T4.RES_ID AS RES_ID ,T4.RES_NAME AS RES_NAME ,T4.RES_URL AS RES_URL ,nvl(T5.RES_ID,'#') AS RES_UP_ID ,T4.RES_CLASS AS RES_CSS ,T4.RES_COLOR AS RES_COLOR ,T4.RES_ICON AS RES_ICON ,T4.RES_TYPE AS RES_TYPE FROM SYS_USER_INFO T0 LEFT JOIN SYS_ROLE_INFO T1 ON DBMS_LOB.INSTR(T0.ROLES ,T1.UUID)>0 LEFT JOIN SYS_DOMAIN_INFO T2 ON T0.DOMAIN_UUID=T2.UUID LEFT JOIN SYS_ORG_INFO T3 ON T0.ORG_UUID=T3.UUID and t0.domain_uuid=t3.domain_uuid LEFT JOIN SYS_RESOURCE_INFO T4 ON decode(t2.domain_id,'root',1, DBMS_LOB.INSTR(T1.RESOURCES ,T4.UUID))>0 LEFT JOIN SYS_RESOURCE_INFO T5 ON T4.RES_UP_UUID=T5.UUID where USER_ID =? group by T2.DOMAIN_ID ,T2.DOMAIN_NAME ,T3.ORG_UNIT_ID ,T3.ORG_UNIT_DESC ,T0.USER_ID ,T0.USER_NAME,T4.UUID ,T4.RES_UP_UUID ,T4.RES_ID ,T4.RES_NAME ,T4.RES_URL ,nvl(T5.RES_ID,'#') ,T4.RES_CLASS ,T4.RES_COLOR ,T4.RES_ICON ,T4.RES_TYPE ) ,TMP_USER_RES as ( SELECT t.DOMAIN_ID, t.DOMAIN_NAME, t.ORG_UNIT_ID, t.ORG_UNIT_DESC, t.USER_ID, t.USER_NAME, t.TOP_RES_ID, t.RES_UUID, t.RES_UP_UUID, t.RES_ID, t.RES_NAME, t.RES_URL, t.RES_UP_ID, t.RES_CSS, t.RES_COLOR, t.RES_ICON, t.RES_TYPE, level as lvl FROM TMP_USERS t start with res_id =TOP_RES_ID connect by prior res_uuid =res_up_uuid ) select sri.uuid as id,sri.res_up_uuid as pid,trim(sri.res_name) name, nvl2(tur.RES_UUID,'false','true') chkDisabled from SYS_RESOURCE_INFO sri LEFT JOIN TMP_USER_RES tur ON tur.RES_UUID=sri.uuid start with sri.res_up_uuid ='#' connect by prior sri.uuid =sri.res_up_uuid order by nvl2(tur.RES_UUID,'false','true') ,sri.res_id asc >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = orgMgmt.sql.xml, sql key = tianjian.org.rootSelect, sql content =  SELECT T3.UUID, T3.ORG_UNIT_ID, T3.ORG_UNIT_DESC, T3.ORG_UP_UUID, T3.DOMAIN_UUID, T3.MEMO, T5.ORG_UNIT_DESC AS UP_ORG_UNIT_DESC, T2.DOMAIN_NAME, level FROM SYS_ORG_INFO T3 LEFT JOIN SYS_DOMAIN_INFO T2 ON T3.DOMAIN_UUID=T2.UUID LEFT JOIN SYS_ORG_INFO T5 ON T5.UUID=T3.ORG_UP_UUID START WITH T3.ORG_UP_UUID=(select T4.UUID FROM SYS_ORG_INFO T4 WHERE T4.ORG_UP_UUID='#') AND T3.DOMAIN_UUID=? CONNECT BY PRIOR T3.UUID =T3.ORG_UP_UUID >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = orgMgmt.sql.xml, sql key = tianjian.org.notRootSelect, sql content =  SELECT T3.UUID, T3.ORG_UNIT_ID, T3.ORG_UNIT_DESC, T3.ORG_UP_UUID, T3.DOMAIN_UUID, T3.MEMO, T5.ORG_UNIT_DESC AS UP_ORG_UNIT_DESC, T2.DOMAIN_NAME, level FROM SYS_ORG_INFO T3 LEFT JOIN SYS_DOMAIN_INFO T2 ON T3.DOMAIN_UUID = T2.UUID LEFT JOIN SYS_ORG_INFO T5 ON T5.UUID = T3.ORG_UP_UUID START WITH T3.UUID= ( select T1.ORG_UUID from SYS_USER_INFO T1 where T1.user_id = ? ) AND T3.DOMAIN_UUID= ( SELECT T.uuid FROM sys_domain_info T WHERE T.DOMAIN_ID =( SELECT t2.DOMAIN_ID FROM sys_user_info t LEFT JOIN sys_domain_info t2 ON t2.UUID = t.DOMAIN_UUID WHERE t.USER_ID=? ) ) CONNECT BY PRIOR T3.UUID =T3.ORG_UP_UUID >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = orgMgmt.sql.xml, sql key = tianjian.org.getOrgInfo, sql content =  SELECT T3.UUID AS ID, T3.ORG_UNIT_DESC AS NAME, T3.ORG_UP_UUID AS PID FROM SYS_ORG_INFO T3 where domain_uuid=? or t3.uuid= (select uuid from sys_org_info where org_up_uuid ='#') start with ( t3.uuid= ( select uuid from sys_org_info where org_up_uuid ='#') ) connect by prior t3.uuid = org_up_uuid >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = orgMgmt.sql.xml, sql key = tianjian.org.notRootOrgInfo, sql content =  SELECT T3.UUID AS ID ,T3.ORG_UNIT_DESC AS NAME ,T3.ORG_UP_UUID AS PID FROM SYS_ORG_INFO T3 LEFT JOIN SYS_DOMAIN_INFO T2 ON T3.DOMAIN_UUID = T2.UUID where rownum<=2 start with ( t3.uuid=? and domain_uuid=? ) connect by t3.uuid = prior org_up_uuid union SELECT T3.UUID AS ID ,T3.ORG_UNIT_DESC AS NAME ,T3.ORG_UP_UUID AS PID FROM SYS_ORG_INFO T3 LEFT JOIN SYS_DOMAIN_INFO T2 ON T3.DOMAIN_UUID = T2.UUID start with ( t3.uuid=? and domain_uuid=? ) connect by prior t3.uuid = org_up_uuid >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = orgMgmt.sql.xml, sql key = tianjian.org.getSubOrg, sql content =  select * from sys_org_info t start with t.ORG_UP_UUID=? connect by PRIOR T.UUID=T.ORG_UP_UUID >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = orgMgmt.sql.xml, sql key = tianjian.org.repeatSelect, sql content =  select t.* from sys_org_info t where t.DOMAIN_UUID=? and t.ORG_UNIT_ID=? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = orgMgmt.sql.xml, sql key = tianjian.org.uptRepeatSelect, sql content =  select * from sys_org_info t where 1=1 and t.DOMAIN_UUID = ? and t.ORG_UNIT_ID=? and t.uuid <> ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = orgMgmt.sql.xml, sql key = tianjian.org.notRootScopeInfo, sql content =  SELECT T.* FROM SYS_DOMAIN_INFO T WHERE T.UUID=(SELECT T.DOMAIN_UUID FROM SYS_USER_INFO T WHERE T.USER_ID=?) >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.sys.pageSelect, sql content =  select * from sys_domain_info t where 1=1 and t.DOMAIN_UP_UUID != '#' order by t.modified_date desc >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.sys.roleSelect, sql content =  SELECT t2.domain_id FROM SYS_USER_INFO T0 LEFT JOIN SYS_DOMAIN_INFO T2 ON T0.DOMAIN_UUID=T2.UUID where t0.user_id = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.sys.notRootpageSelect, sql content =  select * from sys_domain_info t where t.uuid=(select t.domain_uuid from sys_user_info　t where t.user_id=?) order by t.modified_date desc >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.sys.repeatSelect, sql content =  select * from sys_domain_info t where 1=1 and (t.domain_id = ? or domain_name = ?) >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.sys.uptRepeatSelect, sql content =  select * from sys_domain_info t where 1=1 and (t.domain_id = ? or domain_name = ?) and t.uuid <> ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.sys.rootSelect, sql content =  select t.UUID from sys_domain_info t where 1=1 and t.domain_up_uuid = '#' >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.sys.orgSelect, sql content =  SELECT T.* FROM SYS_ORG_INFO T WHERE T.DOMAIN_UUID = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = sysMgmt.sql.xml, sql key = tianjian.sys.paramSelect, sql content =  SELECT T.* from SYS_DOMAIN_INFO T WHERE (T.DOMAIN_ID LIKE ? OR T.DOMAIN_NAME LIKE ?) and t.DOMAIN_UP_UUID != '#' order by t.modified_date desc >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = UsrMgmt.sql.xml, sql key = tianjian.usrMgmt.selectInitOrganization, sql content =  SELECT UUID,DOMAIN_UUID,USER_ID,ORG_UUID FROM SYS_USER_INFO WHERE USER_ID=? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = UsrMgmt.sql.xml, sql key = tianjian.usrMgmt.initSelect, sql content =  SELECT A.UUID, A.DOMAIN_UUID, D.DOMAIN_NAME, A.USER_ID, A.ORG_UUID, A.USER_NAME, A.USER_PHONE, A.USER_EMAIL, B.ORG_UNIT_ID, B.ORG_UNIT_DESC, dao_concat(C.UUID ) AS ROLE_UUIDS, dao_concat(C.ROLE_NAME ) AS ROLE_NAMES FROM SYS_USER_INFO A INNER JOIN (SELECT T.UUID, T.DOMAIN_UUID, T.ORG_UNIT_ID, T.ORG_UNIT_DESC FROM SYS_ORG_INFO T START WITH T.UUID = ? CONNECT BY PRIOR T.UUID = T.ORG_UP_UUID) B ON A.ORG_UUID = B.UUID LEFT JOIN SYS_ROLE_INFO C ON DBMS_LOB.INSTR(A.ROLES, C.UUID) > 0 LEFT JOIN SYS_DOMAIN_INFO D ON A.DOMAIN_UUID = D.UUID WHERE D.DOMAIN_ID != 'root' GROUP BY A.UUID, A.DOMAIN_UUID, D.DOMAIN_NAME, A.USER_ID, A.ORG_UUID, A.USER_NAME, A.USER_PHONE, A.USER_EMAIL, B.ORG_UNIT_ID, B.ORG_UNIT_DESC order by D.DOMAIN_NAME, B.ORG_UNIT_ID,A.USER_ID >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = UsrMgmt.sql.xml, sql key = tianjian.usrMgmt.selectDomain, sql content =  SELECT T.UUID, T.DOMAIN_ID, T.DOMAIN_NAME, DECODE(T.UUID, A.DOMAIN_UUID, 'SELECTED', '') AS SELECTED FROM SYS_DOMAIN_INFO T LEFT JOIN SYS_USER_INFO A ON A.DOMAIN_UUID = T.UUID AND A.USER_ID = ? WHERE T.DOMAIN_UP_UUID <> '#' START WITH T.UUID = A.DOMAIN_UUID CONNECT BY PRIOR T.UUID = T.DOMAIN_UP_UUID >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = UsrMgmt.sql.xml, sql key = tianjian.usrMgmt.checkUserId, sql content =  SELECT UUID,DOMAIN_UUID,USER_ID,ORG_UUID FROM SYS_USER_INFO WHERE USER_ID=? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = UsrMgmt.sql.xml, sql key = tianjian.usrMgmt.selectOrganization, sql content =  SELECT T.UUID, T.DOMAIN_UUID, T.ORG_UNIT_ID, T.ORG_UNIT_DESC, DECODE(T.UUID, A.ORG_UUID, 'SELECTED', '') AS SELECTED FROM SYS_ORG_INFO T LEFT JOIN SYS_USER_INFO A ON A.ORG_UUID = T.UUID AND A.USER_ID = ? START WITH T.UUID = A.ORG_UUID CONNECT BY PRIOR T.UUID = T.ORG_UP_UUID >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = UsrMgmt.sql.xml, sql key = tianjian.usrMgmt.selectRole, sql content =  SELECT T.UUID AS DOMAIN_UUID, A.UUID AS ROLE_UUID, A.ROLE_ID, A.ROLE_NAME FROM (SELECT T.UUID, T.DOMAIN_ID, T.DOMAIN_NAME, DECODE(T.UUID, A.DOMAIN_UUID, 'SELECTED', '') AS SELECTED FROM SYS_DOMAIN_INFO T LEFT JOIN SYS_USER_INFO A ON A.DOMAIN_UUID = T.UUID AND A.USER_ID = ? WHERE T.DOMAIN_UP_UUID <> '#' START WITH T.UUID = A.DOMAIN_UUID CONNECT BY PRIOR T.UUID = T.DOMAIN_UP_UUID) T INNER JOIN SYS_ROLE_INFO A ON T.UUID = A.DOMAIN_UUID >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = UsrMgmt.sql.xml, sql key = tianjian.usrMgmt.batchDelete, sql content =  DELETE FROM SYS_USER_INFO WHERE UUID IN (?) >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = UsrMgmt.sql.xml, sql key = tianjian.usrMgmt.batchReset, sql content =  UPDATE SYS_USER_INFO SET USER_PWD=? WHERE UUID IN (?) >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = UsrMgmt.sql.xml, sql key = tianjian.usrMgmt.findsingle, sql content =  select t.uuid, t.user_id, t.user_name, dao_concat(C.ROLE_NAME ) as roles, t.user_phone, t.user_email, a.org_unit_desc, b.domain_name from SYS_USER_INFO t inner join SYS_ORG_INFO a on t.org_uuid = a.uuid inner join sys_domain_info b on t.domain_uuid = b.uuid
LEFT JOIN SYS_ROLE_INFO c ON DBMS_LOB.INSTR(t.ROLES ,c.UUID)>0 where t.uuid = ? group by t.uuid, t.user_id, t.user_name, t.user_phone, t.user_email, a.org_unit_desc, b.domain_name >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = UsrMgmt.sql.xml, sql key = tianjian.usrMgmt.loginrolecheck, sql content =  select T0.user_id USER_UUID, t1.role_name as user_role FROM SYS_USER_INFO T0 inner JOIN SYS_ROLE_INFO T1 ON DBMS_LOB.INSTR(T0.ROLES, T1.UUID) > 0 where t0.user_id = ? >
2017-04-13 15:06:06 DEBUG <sql加载, sql file = UsrMgmt.sql.xml, sql key = tianjian.usrMgmt.paramSelect, sql content =  SELECT A.UUID, A.DOMAIN_UUID, D.DOMAIN_NAME, A.USER_ID, A.ORG_UUID, A.USER_NAME, A.USER_PHONE, A.USER_EMAIL, B.ORG_UNIT_ID, B.ORG_UNIT_DESC, dao_concat(C.UUID ) AS ROLE_UUIDS, dao_concat(C.ROLE_NAME ) AS ROLE_NAMES FROM SYS_USER_INFO A INNER JOIN (SELECT T.UUID, T.DOMAIN_UUID, T.ORG_UNIT_ID, T.ORG_UNIT_DESC FROM SYS_ORG_INFO T START WITH T.UUID = ? CONNECT BY PRIOR T.UUID = T.ORG_UP_UUID) B ON A.ORG_UUID = B.UUID LEFT JOIN SYS_ROLE_INFO C ON DBMS_LOB.INSTR(A.ROLES, C.UUID) > 0 LEFT JOIN SYS_DOMAIN_INFO D ON A.DOMAIN_UUID = D.UUID WHERE D.DOMAIN_ID != 'root' and (A.USER_ID LIKE ? OR A.USER_NAME LIKE ?) GROUP BY A.UUID, A.DOMAIN_UUID, D.DOMAIN_NAME, A.USER_ID, A.ORG_UUID, A.USER_NAME, A.USER_PHONE, A.USER_EMAIL, B.ORG_UNIT_ID, B.ORG_UNIT_DESC order by D.DOMAIN_NAME, B.ORG_UNIT_ID,A.USER_ID >
2017-04-13 15:06:06 DEBUG <beetl解析sql>
2017-04-13 15:06:06 DEBUG <beetl解析sql>
